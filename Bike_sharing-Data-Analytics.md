Bike Sharing System Data Analytics
================
Yash Prakash
31 August 2019

Introduction
============

Bike sharing systems are a means of renting bicycles where the process of obtaining membership, rental, and bike return is automated via a network of kiosk locations throughout a city. Using these systems, people are able rent a bike from a one location and return it to a different place on an as needed basis. Currently, there are over 500 bike-sharing programs around the world.

The data generated by these systems makes them attractive for researchers because the duration of travel, departure location, arrival location, and time elapsed is explicitly recorded. Bike sharing systems therefore function as a sensor network, which can be used for studying mobility in a city.

The Problem
===========

In this project, we have combined historical usage patterns with weather data in order to perform exploratory data analysis and multivariate analysis (hypothesis testing) on bike rental demand and attempt to accurately forecast bike rental demand based on the same variables.

Loading the Dataset
-------------------

Viewing the features of the data
--------------------------------

The various columns of the record of bike-sharing data are as follows:

``` r
head(train)
```

    ##              datetime season holiday workingday weather temp  atemp
    ## 1 2011-01-01 00:00:00      1       0          0       1 9.84 14.395
    ## 2 2011-01-01 01:00:00      1       0          0       1 9.02 13.635
    ## 3 2011-01-01 02:00:00      1       0          0       1 9.02 13.635
    ## 4 2011-01-01 03:00:00      1       0          0       1 9.84 14.395
    ## 5 2011-01-01 04:00:00      1       0          0       1 9.84 14.395
    ## 6 2011-01-01 05:00:00      1       0          0       2 9.84 12.880
    ##   humidity windspeed casual registered count
    ## 1       81    0.0000      3         13    16
    ## 2       80    0.0000      8         32    40
    ## 3       80    0.0000      5         27    32
    ## 4       75    0.0000      3         10    13
    ## 5       75    0.0000      0          1     1
    ## 6       75    6.0032      0          1     1

Looking at the features of the data:
------------------------------------

datetime - hourly date + timestamp
season - 1 = spring, 2 = summer, 3 = fall, 4 = winter holiday - whether the day is considered a holiday workingday - whether the day is neither a weekend nor holiday weather - 1: Clear, Few clouds, Partly cloudy, Partly cloudy 2: Mist + Cloudy, Mist + Broken clouds, Mist + Few clouds, Mist 3: Light Snow, Light Rain + Thunderstorm + Scattered clouds, Light Rain + Scattered clouds 4: Heavy Rain + Ice Pallets + Thunderstorm + Mist, Snow + Fog temp - temperature in Celsius atemp - "feels like" temperature in Celsius humidity - relative humidity windspeed - wind speed casual - number of non-registered user rentals initiated registered - number of registered user rentals initiated count - number of total rentals

The dimensions of train set is:

``` r
dim(train)
```

    ## [1] 10886    12

``` r
head(test)
```

    ##              datetime season holiday workingday weather  temp  atemp
    ## 1 2011-01-20 00:00:00      1       0          1       1 10.66 11.365
    ## 2 2011-01-20 01:00:00      1       0          1       1 10.66 13.635
    ## 3 2011-01-20 02:00:00      1       0          1       1 10.66 13.635
    ## 4 2011-01-20 03:00:00      1       0          1       1 10.66 12.880
    ## 5 2011-01-20 04:00:00      1       0          1       1 10.66 12.880
    ## 6 2011-01-20 05:00:00      1       0          1       1  9.84 11.365
    ##   humidity windspeed
    ## 1       56   26.0027
    ## 2       56    0.0000
    ## 3       56    0.0000
    ## 4       56   11.0014
    ## 5       56   11.0014
    ## 6       60   15.0013

The dimensions of the test is:

``` r
dim(test)
```

    ## [1] 6493    9

Combining test with train
-------------------------

This is done to get the overall larger set of data to train on.

``` r
test$registered=0
test$casual=0
test$count=0
data=rbind(train,test)
```

The dimensions of the dataframe 'data' now is:

``` r
dim(data)
```

    ## [1] 17379    12

The structure of the data:

``` r
str(data)
```

    ## 'data.frame':    17379 obs. of  12 variables:
    ##  $ datetime  : Factor w/ 17379 levels "2011-01-01 00:00:00",..: 1 2 3 4 5 6 7 8 9 10 ...
    ##  $ season    : int  1 1 1 1 1 1 1 1 1 1 ...
    ##  $ holiday   : int  0 0 0 0 0 0 0 0 0 0 ...
    ##  $ workingday: int  0 0 0 0 0 0 0 0 0 0 ...
    ##  $ weather   : int  1 1 1 1 1 2 1 1 1 1 ...
    ##  $ temp      : num  9.84 9.02 9.02 9.84 9.84 ...
    ##  $ atemp     : num  14.4 13.6 13.6 14.4 14.4 ...
    ##  $ humidity  : int  81 80 80 75 75 75 80 86 75 76 ...
    ##  $ windspeed : num  0 0 0 0 0 ...
    ##  $ casual    : num  3 8 5 3 0 0 2 1 1 8 ...
    ##  $ registered: num  13 32 27 10 1 1 0 2 7 6 ...
    ##  $ count     : num  16 40 32 13 1 1 2 3 8 14 ...

Here: The dependent variables include only: casual, registered and the total count of users

Data Visualisations
-------------------

Plotting the histogram for every independent variable

``` r
par(mfrow=c(4,2))
par(mar = rep(2, 4))
hist(data$season)
hist(data$weather)
hist(data$humidity)
hist(data$holiday)
hist(data$workingday)
hist(data$temp)
hist(data$atemp)
hist(data$windspeed)
```

![](Bike_sharing-Data-Analytics_files/figure-markdown_github/unnamed-chunk-8-1.png)

### Analysing probability distributions

1.  For weather variable

``` r
prop.table(table(data$weather))
```

    ## 
    ##            1            2            3            4 
    ## 0.6567121238 0.2614649865 0.0816502676 0.0001726221

Thus, Weather 1 ( mostly clear weather) has more counts of users

1.  For working day variable

``` r
prop.table(table(data$workingday))
```

    ## 
    ##         0         1 
    ## 0.3172795 0.6827205

Thus, working day has more counts of users using the bikes

1.  Holiday or not

``` r
prop.table(table(data$holiday))
```

    ## 
    ##          0          1 
    ## 0.97122964 0.02877036

Thus, no holiday means more bike rental.

1.  Seasons variable

``` r
prop.table(table(data$season))
```

    ## 
    ##         1         2         3         4 
    ## 0.2440877 0.2536970 0.2587030 0.2435123

Thus, almost equal distribution in all 4 seasons.

### Converting the discrete variables into factor (season, weather, holiday, workingday)

``` r
data$season<-as.factor(data$season)
data$weather<-as.factor(data$weather)
data$holiday<-as.factor(data$holiday)
data$workingday<-as.factor(data$workingday)
```

Viewing the structure of the new data:

``` r
str(data)
```

    ## 'data.frame':    17379 obs. of  12 variables:
    ##  $ datetime  : Factor w/ 17379 levels "2011-01-01 00:00:00",..: 1 2 3 4 5 6 7 8 9 10 ...
    ##  $ season    : Factor w/ 4 levels "1","2","3","4": 1 1 1 1 1 1 1 1 1 1 ...
    ##  $ holiday   : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...
    ##  $ workingday: Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...
    ##  $ weather   : Factor w/ 4 levels "1","2","3","4": 1 1 1 1 1 2 1 1 1 1 ...
    ##  $ temp      : num  9.84 9.02 9.02 9.84 9.84 ...
    ##  $ atemp     : num  14.4 13.6 13.6 14.4 14.4 ...
    ##  $ humidity  : int  81 80 80 75 75 75 80 86 75 76 ...
    ##  $ windspeed : num  0 0 0 0 0 ...
    ##  $ casual    : num  3 8 5 3 0 0 2 1 1 8 ...
    ##  $ registered: num  13 32 27 10 1 1 0 2 7 6 ...
    ##  $ count     : num  16 40 32 13 1 1 2 3 8 14 ...

Here: The categorical variables are: Datetime, season, holiday, workingday, weather.

The numerical variables are: temp, atemp, humidity and windspeed

### Hypothesis Testing (multivariate analysis of the data)

#### 1. Hourly trend

Hourly trend: There must be high demand during office timings. Early morning and late evening can have different trend (cyclist) and low demand during 10:00 pm to 4:00 am. Extract using datetime column

``` r
data$hour<-substr(data$datetime,12,13)
data$hour<-as.factor(data$hour)
```

Greater than 20 users , less than 19 users

``` r
train<-data[as.integer(substr(data$datetime,9,10))<20,]
test<-data[as.integer(substr(data$datetime,9,10))>19,]
```

Visualising it:

``` r
par(mfrow = c(1,1))
boxplot(train$count~train$hour,xlab="hour", ylab="count of users")
```

![](Bike_sharing-Data-Analytics_files/figure-markdown_github/unnamed-chunk-17-1.png)

Thus, most users in the following trend: High : 7-9 and 17-19 hours Average : 10-16 hours Low : 0-6 and 20-24 hours

#### Hypothesis 2. Weekdays Trend

To see if the registered users use bike system more on weekdays than weekends.

``` r
date <- substr(data$datetime,1,10)
days<-weekdays(as.Date(date))
data$day=days
```

Visualising it:

``` r
boxplot(data$registered ~ data$day, xlab = "day", ylab = "count of registered users")
```

![](Bike_sharing-Data-Analytics_files/figure-markdown_github/unnamed-chunk-19-1.png)

``` r
boxplot(data$casual ~ data$day, xlab = "day", ylab = "count of casual users")
```

![](Bike_sharing-Data-Analytics_files/figure-markdown_github/unnamed-chunk-20-1.png)

Thus, it can be seen that the casual users prefer to use the bikes more on weekends while registered users do so more on weekdays.

#### Hypothesis 3: 'Rain' Trend:

People prefer to rent bikes more on clear weather than rainy for total users

``` r
boxplot(data$count ~ data$weather, xlab= "Weather conditions", ylab = "Count of total users")
```

![](Bike_sharing-Data-Analytics_files/figure-markdown_github/unnamed-chunk-21-1.png)

For registered users

``` r
boxplot(data$registered ~ data$weather, xlab= "Weather conditions", ylab = "Count of registered users")
```

![](Bike_sharing-Data-Analytics_files/figure-markdown_github/unnamed-chunk-22-1.png)

For casual users

``` r
boxplot(data$casual ~ data$weather, xlab= "Weather conditions", ylab = "Count of casual users")
```

![](Bike_sharing-Data-Analytics_files/figure-markdown_github/unnamed-chunk-23-1.png)

#### Hypothesis 4: The correlation table of continous variables

Variables lile wind, temperature and humididity with the reg, casual and total user count

Making a subset of data and displaying the co-relation table:

``` r
subset <- data.frame(train$registered, train$casual, train$count, train$temp, 
                     train$humidity, train$atemp, train$windspeed)
cor_sub <- cor(subset)
```

Visualising the correlations:

``` r
library(corrplot)
```

    ## corrplot 0.84 loaded

``` r
corrplot(cor_sub, method = 'color')
```

![](Bike_sharing-Data-Analytics_files/figure-markdown_github/unnamed-chunk-25-1.png)

The inferences are: 1. Variable atemp is highly correlated with temp. 2. Variable temp is positively correlated with the dependent variables (casual is more compare to registered) 3. Windspeed has lower correlation as compared to temp and humidity

### Multi-Variable Analysis

#### Looking over the count of Bikes Rented by hour and season

``` r
library(sqldf)
```

    ## Loading required package: gsubfn

    ## Loading required package: proto

    ## Loading required package: RSQLite

``` r
library(ggplot2)
# Get the average count of bikes rent by season, hour
season_summary_by_hour <- sqldf('select season, hour, avg(count) as count from data group by season, hour')

ggplot(data, aes(x=hour, y=count, color=season))+geom_point(data = season_summary_by_hour, aes(group = season))+geom_line(data = season_summary_by_hour, aes(group = season))+ggtitle("Bikes Rent By Season and Hour")+ scale_colour_hue('Season',breaks = levels(data$season), labels=c('spring', 'summer', 'fall', 'winter'))
```

![](Bike_sharing-Data-Analytics_files/figure-markdown_github/unnamed-chunk-26-1.png)

Here, we see that most bikes are rented during the hours of 17-19 in the seasons of fall and summer with the least in spring.

#### Looking over the bikes rented by weather and hour

``` r
# Get the average count of bikes rent by weather, hour
weather_summary_by_hour <- sqldf('select weather, hour, avg(count) as count from data group by weather, hour')


ggplot(data, aes(x=hour, y=count, color=weather))+geom_point(data = weather_summary_by_hour, aes(group = weather))+geom_line(data = weather_summary_by_hour, aes(group = weather))+ggtitle("Bikes Rent By Weather and Hour")+ scale_colour_hue('Weather',breaks = levels(data$weather), labels=c('Good', 'Normal', 'Bad', 'Very Bad'))
```

![](Bike_sharing-Data-Analytics_files/figure-markdown_github/unnamed-chunk-27-1.png)

From this plot it is seen that, 1. People rent bikes the most when weather is good and between hours 17 - 19 2. We see bike rentals are minimum during the early hours of the morning and during bad weather

#### Looking over the bikes rented by the weekdays and hour

``` r
# Get the average count of bikes rent by day, hour
day_summary_by_hour <- sqldf('select day, hour, avg(count) as count from data group by day, hour')

ggplot(data, aes(x=hour, y=count, color=day, label= TRUE))+geom_point(data = day_summary_by_hour, aes(group = day))+geom_line(data = day_summary_by_hour, aes(group = day))+ggtitle("Bikes Rent By the days and Hours")+ scale_colour_hue('Weekday',breaks = levels(data$day), labels=c('Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sunday'))
```

![](Bike_sharing-Data-Analytics_files/figure-markdown_github/unnamed-chunk-28-1.png)

Here we can see that, 1. There are more bikes rented on weekdays during 7-9 hours in the morning and 17-19 hours in the evening 2. There are more bikes rentals between 12 - 16 hours on weekends
